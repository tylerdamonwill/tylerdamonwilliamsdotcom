
<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>YouTube iframe player with Custom Link Tracking</title>

<script type="text/javascript">
</script>
</head>
<body>
<h2>YouTube iframe player with Custom Link Tracking</h2>
  
<iframe id="player" width="560" height="315" src="https://www.youtube.com/embed/-J_jCwXrS5E?enablejsapi=1&rel=0" frameborder="0" allowfullscreen></iframe>

<iframe width="966" height="537" src="https://www.youtube.com/embed/xEpH6gj9p7Y" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<iframe width="764" height="573" src="https://www.youtube.com/embed/HffOj--p9bU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<script type="text/javascript">
/* YouTube Player Mapping for multiple embedded videos (https://developers.google.com/youtube/iframe_api_reference) */
var playerInfoList=new Array();
$("[id^='player']").each(function(){
  var player=$(this).attr('id');
  playerInfoList.push(player);
});
var players=new Array();
window.onYouTubeIframeAPIReady = function() {
  for(x=0;x<playerInfoList.length;x++){
    players[x] = new YT.Player(playerInfoList[x], {
        events: {
            'onStateChange': onPlayerStateChange
    }
  });
  }
}
function onPlayerStateChange(event) {
    if (event.data == YT.PlayerState.PLAYING) {
                var videoPlayer = "YouTube";
                var videoTitle = event.target.getVideoData().title;
                var videoId = event.target.getVideoData().video_id;
                var mediaName = videoPlayer+'|'+videoId+'|'+videoTitle;
                var mediaLength = Math.floor(event.target.getDuration());
                var mediaOffset = Math.floor(event.target.getCurrentTime());
            if (mediaOffset === 0) {
        console.log('videoStart: ' + mediaName + ' at ' + event.target.getCurrentTime());
            } else {
                console.log('videoResume: ' + mediaName + ' at ' + event.target.getCurrentTime())
            };
    }
    if (event.data == YT.PlayerState.PAUSED) {
            var videoPlayer = "YouTube";
            var videoTitle = event.target.getVideoData().title;
            var videoId = event.target.getVideoData().video_id;
            var mediaName = videoPlayer+'|'+videoId+'|'+videoTitle;
      console.log('videoPaused: ' + mediaName + ' at ' + event.target.getCurrentTime())
    }
    if (event.data == YT.PlayerState.BUFFERING) {
            var videoPlayer = "YouTube";
            var videoTitle = event.target.getVideoData().title;
            var videoId = event.target.getVideoData().video_id;
            var mediaName = videoPlayer+'|'+videoId+'|'+videoTitle;
      console.log('videoBuffering: ' + mediaName + ' at ' + event.target.getCurrentTime())
    }
    if (event.data == YT.PlayerState.ENDED) {
            var videoPlayer = "YouTube";
            var videoTitle = event.target.getVideoData().title;
            var videoId = event.target.getVideoData().video_id;
            var mediaName = videoPlayer+'|'+videoId+'|'+videoTitle;
            console.log('videoEnded: ' + mediaName + ' at ' + event.target.getCurrentTime())
    }
}
/* Loads IFrame Player API Code asynchronously */
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
</script>
</body>
</html>